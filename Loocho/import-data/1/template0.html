<ul class="nav nav-pills nav-wizard">
  <li class="active"><a href="javascript:;" data-toggle="tab">Step 1: Import data</a><div class="nav-arrow"></div></li>
  <li [ngClass]="{'active': step >= 2 }"><div class="nav-wedge"></div><a href="javascript:;" data-toggle="tab">Step 2: Mapping</a><div class="nav-arrow"></div></li>
  <li [ngClass]="{'active': step >= 3 }"><div class="nav-wedge"></div><a href="javascript:;" data-toggle="tab">Step 3: Viewer</a><div class="nav-arrow"></div></li>
  <li [ngClass]="{'active': step === 4 }"><div class="nav-wedge"></div><a href="javascript:;" data-toggle="tab">Step 4: Finish</a></li>
</ul>

<div *ngIf="step === 1">
	<div id="my-drop-zone">
		<img src="media/flat-icons/upload.png">
		Drop files here
	</div><hr />
	<table class="table table-striped table-hover" *ngIf="files.length">
		<thead>
			<tr>
				<th width="5%"><span class="icon-pin"></span> NÂ°</th>
				<th width="20%"><span class="icon-doc"></span> Name</th>
				<th width="10%"><span class="icon-compass"></span> Size</th>
				<th width="30%"><span class="icon-tag"></span> Type</th>
				<th width="15%"><span class="icon-cloud-upload"></span> Ressource</th>
				<th width="10%"><span class="icon-shuffle"></span> Delete</th>
				<th width="10%"><span class="icon-shuffle"></span> Property</th>
			</tr>
		</thead>
		<tbody>
			<tr *ngFor="let item of files; let i = index;">
				<td>{{setId(i, item)}}</td>
				<td><strong>{{item.name}}</strong></td>
				<td>{{item.size}}</td>
				<td>{{item.type}}</td>
				<td>
					<select class="form-control input-sm" style="width: 100%" [(ngModel)]="item.resource">
						<option value=""></option>
						<option [value]="resource.core" *ngFor="let resource of schemas">{{resource.core}}</option>
					</select>
				</td>
				<td>
					<button type="button" class="btn btn-default btn-xs" (click)="removeFile(i)" style="width: 100px; height: 30px;">
						<span class="glyphicon glyphicon-trash"></span> Remove
					</button>
				</td>
				<td>
					<button type="button"
						class="btn btn-default btn-xs"
						(click)="seeSchema(item.resource)"
						style="width: 100px; height: 30px;"
						[disabled]="!item.resource">
						<span class="glyphicon glyphicon-eye-open"></span> See Schema
					</button>
				</td>
			</tr>
		</tbody>
	</table>
</div>

<div *ngIf="step === 2">
	<div class="col-md-2 align-centered listFileToSelect">
    <select #fileSelected (change)="onChangeFile(fileSelected.value)" class="form-control-loocho">
			<option value="" *ngIf="!fileSelected.value"></option>
			<option [value]="file.id" *ngFor="let file of files">{{file.name}}</option>
		</select>
		<button
			class="btn btn-loocho btn-sm"
			(click)="saveMapping(fileSelected.value)"
			[disabled]="!fileSelected.value">
			Save and See the preview
		</button>
  </div>

	<div class="row" style="min-height: 250px;">
		<h1 *ngIf="!linesHeader" style="text-align: center; margin-top: 125px;">Please, choose a file</h1>
		<div *ngIf="linesHeader" class="col-lg-8 elementList">
			<table class="table table-striped table-hover">
				<thead>
					<tr>
						<th width="50%">Column label from csv</th>
						<th width="50%">Preview information</th>
					</tr>
				</thead>
				<tbody id="resultsMap">
					<tr *ngFor="let header of linesHeader">
						<td>{{header}}</td>
						<td id="drop-{{header}}" (drop)="drop($event)" (dragover)="dragOver($event)"></td>
					</tr>
				</tbody>
			</table>
		</div>

		<div *ngIf="linesHeader" class="col-lg-4 elementList" id="propertyList">
			<table class="table table-striped table-hover">
				<thead>
					<tr><th>Loocho property</th></tr>
				</thead>
				<tbody (drop)="drop($event, true)" (dragover)="dragOver($event)">
					<tr *ngFor='let field of currentSchema' id="drag-{{field.title}}-drop">
						<td draggable="true"
								(dragstart)="drag($event)"
								id="drag-{{field.title}}"
								class="draggable">
								{{field.title}} <span style="visibility: hidden"> {{field.field}}</span>
						</td>
					</tr>
				</tbody>
			</table>
		</div>

	</div>
</div>
<br /><br />

<div *ngIf="step === 3">
	<h1>Step 3</h1>
</div>

<div *ngIf="step === 4">
	<h1>Step 4</h1>
</div>

<div class="row-centered">
  <button
		class="btn btn-loocho btn-sm btn-width"
		(click)="preview()"
		[disabled]="disabledNextOrPrevBtn('prev')">
		Preview
	</button>

  <button
		class="btn btn-loocho btn-sm btn-width"
		(click)="next()"
		[disabled]="disabledNextOrPrevBtn('next')">
		Next
	</button>
</div>

<div [displayModal]="showModal"
		 [blocked]="false"
		 [size]="viewerDataHeader ? 'lg' : 'md'"
		 (close)="showModal = schemaProperty = modalMessage = viewerDataHeader = null">
	<div class="modal-dialog modal-content">
		<div class="modal-header">
			<button class="close" (click)="showModal = schemaProperty = modalMessage = viewerDataHeader = null" aria-hidden="true">
				<span class="icon-close"></span>
			</button>
			<h4 class="modal-title">{{modalTitle}}</h4>
		</div>
		<div class="modal-body table-content" style="min-height: 100px; font-size: 15px;">
			<img *ngIf="messageType === 'error'" src="media/flat-icons/caution.png" style="width: 50px; height: 50px; margin-right: 15px;">
			<span *ngIf="modalMessage">{{modalMessage}}</span>
			<div *ngIf="schemaProperty">{{schemaProperty}}</div>
			<div *ngIf="viewerDataHeader" style="font-size: 12px;">
				<table class="table table-striped table-hover">
					<thead>
						<tr>
							<th *ngFor="let head of viewerDataHeader">{{head}}</th>
						</tr>
					</thead>
					<tbody>
						<tr *ngFor="let line of viewerDataContents">
							<td *ngFor="let head of viewerDataProperty">{{line[head]}}</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>